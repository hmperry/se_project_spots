!function(){"use strict";const e={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},t=(e,t,o)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(o.inputErrorClass)},o=(e,t,o)=>{(e=>e.some((e=>!e.validity.valid)))(e)?r(t,o):(t.classList.remove(o.inactiveButtonClass),t.disabled=!1)},r=(e,t)=>{e.classList.add(t.inactiveButtonClass),e.disabled=!0},n=e=>{Array.from(document.querySelectorAll(e.formSelector)).forEach((n=>{((e,n)=>{const a=Array.from(e.querySelectorAll(n.inputSelector)),s=e.querySelector(n.submitButtonSelector);console.log(a),console.log(s),o(a,s,n),e.addEventListener("reset",(()=>{r(s,n)})),a.forEach((r=>{r.addEventListener("input",(function(){((e,o,r)=>{console.log(o.validationMessage),o.validity.valid?t(e,o,r):((e,t,o,r)=>{e.querySelector(`#${t.id}-error`).textContent=o,t.classList.add(r.inputErrorClass)})(e,o,o.validationMessage,r)})(e,r,n),o(a,s,n)}))}))})(n,e)}))};n(e);const a=new class{constructor({baseUrl:e,headers:t,cardID:o}){this._baseUrl=e,this._headers=t}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{method:"GET",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard({name:e,link:t}){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{...this._headers,"Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}changeLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:{...this._headers,"Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInfo({name:e,about:t}){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}changeProfilePicture({avatar:e}){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{...this._headers,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"3865b531-c637-4f08-82ee-36af95a41c77","Content-Type":"application/json"}}),s=document.querySelector(".profile__avatar"),c=document.querySelector(".profile__name"),i=document.querySelector(".profile__title"),l=document.forms["profile-form"],d=document.querySelector(".profile__edit-button"),u=document.querySelector(".image__container"),m=document.querySelector("#avatar-modal"),_=document.querySelector("#avatar-form"),h=m.querySelector(".modal__submit-button"),v=document.querySelector("#avatar-link-input"),f=document.querySelector("#edit-profile-modal"),p=f.querySelector("#profile-name-input"),y=f.querySelector("#profile-description-input"),S=f.querySelector(".modal__submit-button"),C=document.querySelector(".profile__new-post-button"),b=document.querySelector("#add-card-modal"),E=b.querySelector("#add-card-link-input"),k=b.querySelector("#add-card-name-input"),q=document.forms["add-card-form"],g=b.querySelector(".modal__submit-button"),L=document.querySelector("#cards_list"),x=document.querySelector("#card-template"),T=document.querySelector("#preview-modal"),j=T.querySelector(".modal__image"),$=T.querySelector(".modal__caption"),P=document.querySelector("#delete-modal"),U=P.querySelector(".modal__delete-button"),A=document.querySelector(".modal__cancel-button");let D,w;const I=document.querySelectorAll(".modal__close-button"),N=document.querySelectorAll(".modal");a.getAppInfo().then((([e,t])=>{e.forEach((e=>{const t=H(e);L.append(t)})),s.src=t.avatar,console.log(t),i.textContent=t.about,c.textContent=t.name})).catch((e=>{console.error(e)})),l.addEventListener("submit",(function(e){e.preventDefault(),S.textContent="Saving...",a.editUserInfo({name:p.value,about:y.value}).then((e=>{S.textContent="Save",c.textContent=e.name,i.textContent=e.about,G(f)})).catch((()=>{S.textContent="Save failed. Try again.",console.error(),setTimeout((()=>{U.textContent="Save"}),2e3)}))})),U.addEventListener("click",(function(){U.textContent="Deleting...",a.deleteCard(w).then((()=>{U.textContent="Delete",D.remove(),G(P)})).catch((()=>{U.textContent="Delete failed. Try again.",console.error(),setTimeout((()=>{U.textContent="Delete"}),2e3)}))})),A.addEventListener("click",(()=>G(P))),q.addEventListener("submit",(function(e){e.preventDefault(),g.textContent="Saving...";const t={name:k.value,link:E.value},o=H(t);a.addNewCard(t).then((t=>{g.textContent="Save",t.name=k.value,t.link=E.value,G(b),e.target.reset(),L.prepend(o)})).catch((()=>{g.textContent="Save failed. Try again.",console.error(),setTimeout((()=>{g.textContent="Save"}),2e3)}))})),u.addEventListener("click",(()=>{J(m)})),C.addEventListener("click",(()=>{J(b)})),h.addEventListener("click",(function(e){e.preventDefault(),h.textContent="Saving...";const t={avatar:v.value};a.changeProfilePicture(t).then((e=>{h.textContent="Save",e.avatar=v.value,G(m),_.reset(),s.src=e.avatar})).catch((()=>{h.textContent="Save failed. Try again.",console.error(),setTimeout((()=>{h.textContent="Save"}),2e3)}))})),d.addEventListener("click",(function(){var o,r;p.value=c.textContent,y.value=i.textContent,o=l,r=e,[p,y].forEach((e=>{t(o,e,r)})),J(f)}));const B=e=>{N.forEach((t=>{e.target===t&&t.classList.contains("modal_opened")&&G(t)}))},O=e=>{N.forEach((t=>{"Escape"===e.key&&N.forEach(G)}))};function J(e){e.classList.add("modal_opened"),document.addEventListener("mousedown",B),document.addEventListener("keydown",O)}function G(e){e.classList.remove("modal_opened"),document.removeEventListener("mousedown",B),document.removeEventListener("keydown",O)}function H(e){const t=x.content.querySelector(".card").cloneNode(!0);t.querySelector(".card__title").textContent=e.name;const o=t.querySelector(".card__image");o.src=e.link,o.alt=e.name;const r=t.querySelector(".card__like-button");return!0===e.isLiked&&r.classList.add("card__like-button_liked"),r.addEventListener("click",(t=>function(e,t){console.log(t),w=t._id;const o=!!e.target.classList.contains("card__like-button_liked");a.changeLike(t._id,o).then((()=>{!0===o?e.target.classList.remove("card__like-button_liked"):e.target.classList.add("card__like-button_liked")})).catch(console.error)}(t,e))),t.querySelector(".card__delete-button").addEventListener("click",(o=>function(e,t){D=e,w=t._id,J(P)}(t,e))),o.addEventListener("click",(()=>{j.src=e.link,j.alt=e.name,$.textContent=e.name,J(T)})),t}I.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>G(t)))})),n(e)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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c0JBa0IzQyxPQWpCcUIsSUFBakI4RyxFQUFLcEQsU0FDUHdFLEVBQVMvSCxVQUFVVyxJQUFJLDJCQUV6Qm9ILEVBQVMxRyxpQkFBaUIsU0FBVW1GLEdBd0N0QyxTQUF3QkEsRUFBS0csR0FDM0J4RixRQUFRQyxJQUFJdUYsR0FDWmhCLEVBQWlCZ0IsRUFBS3FCLElBQ3RCLE1BQU16RSxJQUFVaUQsRUFBSU8sT0FBTy9HLFVBQVV1SCxTQUFTLDJCQUk5QzdGLEVBQ0c0QixXQUFXcUQsRUFBS3FCLElBQUt6RSxHQUNyQmQsTUFBSyxNQUNZLElBQVpjLEVBQ0ZpRCxFQUFJTyxPQUFPL0csVUFBVUMsT0FBTywyQkFFNUJ1RyxFQUFJTyxPQUFPL0csVUFBVVcsSUFBSSwwQkFDM0IsSUFFRDBGLE1BQU1sRixRQUFRb0YsTUFDbkIsQ0F6RDhDMEIsQ0FBZXpCLEVBQUtHLEtBRTdDVixFQUFZcEcsY0FBYyx3QkFDbEN3QixpQkFBaUIsU0FBVW1GLEdBK0J4QyxTQUEwQlAsRUFBYVUsR0FDckNqQixFQUFlTyxFQUNmTixFQUFpQmdCLEVBQUtxQixJQUN0QmQsRUFBVTNCLEVBQ1osQ0FsQ0kyQyxDQUFpQmpDLEVBQWFVLEtBR2hDa0IsRUFBVXhHLGlCQUFpQixTQUFTLEtBQ2xDZ0UsRUFBa0JlLElBQU1PLEVBQUsxRCxLQUM3Qm9DLEVBQWtCeUMsSUFBTW5CLEVBQUszRCxLQUM3QnNDLEVBQW9CdkYsWUFBYzRHLEVBQUszRCxLQUN2Q2tFLEVBQVU5QixFQUFhLElBR2xCYSxDQUNULENBckNBTCxFQUFhM0UsU0FBU2tILElBQ3BCLE1BQU1DLEVBQVFELEVBQU9FLFFBQVEsVUFDN0JGLEVBQU85RyxpQkFBaUIsU0FBUyxJQUFNdUYsRUFBV3dCLElBQU8sSUFrTDNEeEgsRUFBaUIxQixFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL2FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25faW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvclwiLFxyXG59O1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsLCBpbnB1dEVsLCBlcnJvck1zZywgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsLmlkfS1lcnJvcmApO1xyXG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcclxuICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWwsIGlucHV0RWwsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGVycm9yTXNnRWwgPSBmb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICBlcnJvck1zZ0VsLnRleHRDb250ZW50ID0gXCJcIjtcclxuICBpbnB1dEVsLmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsLCBpbnB1dEVsLCBjb25maWcpID0+IHtcclxuICBjb25zb2xlLmxvZyhpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlKTtcclxuXHJcbiAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWwpID0+IHtcclxuICAgIHJldHVybiAhaW5wdXRFbC52YWxpZGl0eS52YWxpZDtcclxuICB9KTtcclxufTtcclxuXHJcbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgfVxyXG59O1xyXG5cclxuY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcclxuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWwsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWwsIGlucHV0LCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsLCBjb25maWcpID0+IHtcclxuICBjb25zdCBpbnB1dExpc3QgPSBBcnJheS5mcm9tKGZvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbC5xdWVyeVNlbGVjdG9yKGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gIGNvbnNvbGUubG9nKGlucHV0TGlzdCk7XHJcbiAgY29uc29sZS5sb2coYnV0dG9uRWxlbWVudCk7XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICBmb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2V0XCIsICgpID0+IHtcclxuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICB9KTtcclxuXHJcbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgIGlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsKSA9PiB7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWwsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcclxuIiwiaW1wb3J0IHtcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHNldHRpbmdzLFxyXG4gIHJlc2V0VmFsaWRhdGlvbixcclxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7XHJcblxyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvYXBpLmpzXCI7XHJcblxyXG4vLyBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJWYWwgVGhvcmVuc1wiLFxyXG4vLyAgICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL3Nwb3RzLzEtcGhvdG8tYnktbW9yaXR6LWZlbGRtYW5uLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgIH0sXHJcblxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiUmVzdGF1cmFudCB0ZXJyYWNlXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMi1waG90by1ieS1jZWlsaW5lLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgIH0sXHJcblxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiQW4gb3V0ZG9vciBjYWZlXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvMy1waG90by1ieS10dWJhbnVyLWRvZ2FuLWZyb20tcGV4ZWxzLmpwZ1wiLFxyXG4vLyAgIH0sXHJcblxyXG4vLyAgIHtcclxuLy8gICAgIG5hbWU6IFwiQSB2ZXJ5IGxvbmcgYnJpZGdlLCBvdmVyIHRoZSBmb3Jlc3QgYW5kIHRocm91Z2ggdGhlIHRyZWVzXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNC1waG90by1ieS1tYXVyaWNlLWxhc2NoZXQtZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgfSxcclxuXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJUdW5uZWwgd2l0aCBtb3JuaW5nIGxpZ2h0XCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNS1waG90by1ieS12YW4tYW5oLW5ndXllbi1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICB9LFxyXG5cclxuLy8gICB7XHJcbi8vICAgICBuYW1lOiBcIk1vdW50YWluIGhvdXNlXCIsXHJcbi8vICAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvc3BvdHMvNi1waG90by1ieS1tb3JpdHotZmVsZG1hbm4tZnJvbS1wZXhlbHMuanBnXCIsXHJcbi8vICAgfSxcclxuXHJcbi8vICAge1xyXG4vLyAgICAgbmFtZTogXCJHb2xkZW4gR2F0ZSBCcmlkZ2VcIixcclxuLy8gICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9zcG90cy83LXBob3RvLWJ5LWdyaWZmaW4td29vbGRyaWRnZS1mcm9tLXBleGVscy5qcGdcIixcclxuLy8gICB9LFxyXG4vLyBdO1xyXG5cclxuLy9JbnN0YW50aWF0ZSBBcGkgY2xhc3NcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjM4NjViNTMxLWM2MzctNGYwOC04MmVlLTM2YWY5NWE0MWM3N1wiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG4vL1NFTEVDVElORyBFTEVNRU5UU1xyXG5cclxuLy9Qcm9maWxlIEVsZW1lbnRzXHJcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuY29uc3QgZWRpdEZvcm1FbGVtZW50ID0gZG9jdW1lbnQuZm9ybXNbXCJwcm9maWxlLWZvcm1cIl07XHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuXHJcbi8vQXZhdGFyIEVsZW1lbnRzXHJcbmNvbnN0IGNoYW5nZVByb2ZQaWMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlX19jb250YWluZXJcIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1mb3JtXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbFN1Ym1pdCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIik7XHJcbmNvbnN0IGF2YXRhclBpY0xpbmsgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1saW5rLWlucHV0XCIpO1xyXG5cclxuLy9Qcm9maWxlIEVkaXQgTW9kYWwgRWxlbWVudHNcclxuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIik7XHJcbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5jb25zdCBwcm9maWxlRWRpdFN1Ym1pdEJ1dHRvbiA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCJcclxuKTtcclxuXHJcbi8vTmV3IFBvc3QgRWxlbWVudHNcclxuY29uc3QgY2FyZE1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uZXctcG9zdC1idXR0b25cIik7XHJcbmNvbnN0IGNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGNhcmRNb2RhbEltYWdlTGlua0lucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGluay1pbnB1dFwiKTtcclxuY29uc3QgY2FyZE1vZGFsQ2FwdGlvbklucHV0ID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgY2FyZE1vZGFsRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5mb3Jtc1tcImFkZC1jYXJkLWZvcm1cIl07XHJcbmNvbnN0IGNhcmRTdWJtaXRCdXR0b24gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuXHJcbi8vQ2FyZCBHYWxsZXJ5IEVsZW1lbnRzXHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZHNfbGlzdFwiKTtcclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdNb2RhbEltYWdlID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDYXB0aW9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XHJcblxyXG4vL0RlbGV0ZSBNb2RhbCBFbGVtZW50c1xyXG5jb25zdCBkZWxldGVNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLW1vZGFsXCIpO1xyXG5jb25zdCBkZWxldGVCdXR0b24gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19kZWxldGUtYnV0dG9uXCIpO1xyXG5jb25zdCBjYW5jZWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYW5jZWwtYnV0dG9uXCIpO1xyXG5sZXQgc2VsZWN0ZWRDYXJkO1xyXG5sZXQgc2VsZWN0ZWRDYXJkSWQ7XHJcblxyXG4vL0dsb2JhbCBFbGVtZW50c1xyXG5jb25zdCBjbG9zZUJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19jbG9zZS1idXR0b25cIik7XHJcbmNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcblxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlcl0pID0+IHtcclxuICAgIGNhcmRzLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChpdGVtKTtcclxuICAgICAgY2FyZHNMaXN0LmFwcGVuZChjYXJkRWxlbWVudCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwcm9maWxlSW1hZ2Uuc3JjID0gdXNlci5hdmF0YXI7XHJcbiAgICBjb25zb2xlLmxvZyh1c2VyKTtcclxuXHJcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyLmFib3V0O1xyXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyLm5hbWU7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gIH0pO1xyXG5cclxuLy9FVkVOVCBMSVNURU5FUlNcclxuZWRpdEZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xyXG5kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZURlbGV0ZVN1Ym1pdCk7XHJcbmNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gY2xvc2VNb2RhbChkZWxldGVNb2RhbCkpO1xyXG5jYXJkTW9kYWxGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZU5ld1Bvc3RGb3JtU3VibWl0KTtcclxuY2hhbmdlUHJvZlBpYy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChhdmF0YXJNb2RhbCk7XHJcbn0pO1xyXG5jYXJkTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcbmF2YXRhck1vZGFsU3VibWl0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBoYW5kbGVBdmF0YXJTdWJtaXQpO1xyXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFxyXG4gIFwiY2xpY2tcIixcclxuICBoYW5kbGVQcm9maWxlRWRpdFxyXG5cclxuICAvLyAoKSA9PiB7XHJcbiAgLy8gZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgLy8gZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICAvLyByZXNldFZhbGlkYXRpb24oXHJcbiAgLy8gICBlZGl0Rm9ybUVsZW1lbnQsXHJcbiAgLy8gICBbZWRpdE1vZGFsTmFtZUlucHV0LCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0XSxcclxuICAvLyAgIHNldHRpbmdzXHJcbiAgLy8gKTtcclxuICAvLyBvcGVuTW9kYWwoZWRpdE1vZGFsKTt9XHJcbik7XHJcblxyXG4vL0VWRU5UIEhBTkRMRVJTXHJcblxyXG4vL0dsb2JhbCBGdW5jdGlvbmFsaXR5XHJcbmNvbnN0IGhhbmRsZUNsaWNrT3V0c2lkZSA9IChldnQpID0+IHtcclxuICBtb2RhbHMuZm9yRWFjaCgobW9kYWwpID0+IHtcclxuICAgIGlmIChldnQudGFyZ2V0ID09PSBtb2RhbCAmJiBtb2RhbC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcclxuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVFc2NhcGVNb2RhbCA9IChldnQpID0+IHtcclxuICBtb2RhbHMuZm9yRWFjaCgobW9kYWwpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIG1vZGFscy5mb3JFYWNoKGNsb3NlTW9kYWwpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZUNsaWNrT3V0c2lkZSk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlTW9kYWwpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGhhbmRsZUNsaWNrT3V0c2lkZSk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgaGFuZGxlRXNjYXBlTW9kYWwpO1xyXG59XHJcblxyXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgY29uc3QgcG9wdXAgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwocG9wdXApKTtcclxufSk7XHJcblxyXG4vL0NhcmRzIGFuZCBDYXJkIEdhbGxlcnlcclxuZnVuY3Rpb24gZ2V0Q2FyZEVsZW1lbnQoZGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcclxuICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gIGNvbnN0IGNhcmROYW1lID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICBjYXJkTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuXHJcbiAgY29uc3QgY2FyZEltYWdlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICBjYXJkSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcblxyXG4gIGNvbnN0IGNhcmRMaWtlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICBpZiAoZGF0YS5pc0xpa2VkID09PSB0cnVlKSB7XHJcbiAgICBjYXJkTGlrZS5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIik7XHJcbiAgfVxyXG4gIGNhcmRMaWtlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiBoYW5kbGVMaWtlQ2FyZChldnQsIGRhdGEpKTtcclxuXHJcbiAgY29uc3QgY2FyZERlbGV0ZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuICBjYXJkRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PlxyXG4gICAgaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgZGF0YSlcclxuICApO1xyXG5cclxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIHByZXZpZXdNb2RhbEltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgIHByZXZpZXdNb2RhbEltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHByZXZpZXdNb2RhbENhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZVN1Ym1pdCgpIHtcclxuICAvLyBldnQucHJldmVudERlZmF1bHQoKTtcclxuICBkZWxldGVCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XHJcbiAgYXBpXHJcbiAgICAuZGVsZXRlQ2FyZChzZWxlY3RlZENhcmRJZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgZGVsZXRlQnV0dG9uLnRleHRDb250ZW50ID0gXCJEZWxldGVcIjtcclxuICAgICAgc2VsZWN0ZWRDYXJkLnJlbW92ZSgpO1xyXG4gICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKCkgPT4ge1xyXG4gICAgICBkZWxldGVCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0ZSBmYWlsZWQuIFRyeSBhZ2Fpbi5cIjtcclxuICAgICAgY29uc29sZS5lcnJvcigpO1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBkZWxldGVCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0ZVwiO1xyXG4gICAgICB9LCAyMDAwKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZEVsZW1lbnQsIGRhdGEpIHtcclxuICBzZWxlY3RlZENhcmQgPSBjYXJkRWxlbWVudDtcclxuICBzZWxlY3RlZENhcmRJZCA9IGRhdGEuX2lkO1xyXG4gIG9wZW5Nb2RhbChkZWxldGVNb2RhbCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDYXJkKGV2dCwgZGF0YSkge1xyXG4gIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gIHNlbGVjdGVkQ2FyZElkID0gZGF0YS5faWQ7XHJcbiAgY29uc3QgaXNMaWtlZCA9IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idXR0b25fbGlrZWRcIilcclxuICAgID8gdHJ1ZVxyXG4gICAgOiBmYWxzZTtcclxuXHJcbiAgYXBpXHJcbiAgICAuY2hhbmdlTGlrZShkYXRhLl9pZCwgaXNMaWtlZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgaWYgKGlzTGlrZWQgPT09IHRydWUpIHtcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5cclxuLy9DcmVhdGUgTmV3IFBvc3RcclxuZnVuY3Rpb24gaGFuZGxlTmV3UG9zdEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY2FyZFN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcblxyXG4gIGNvbnN0IGlucHV0VmFsdWVzID0ge1xyXG4gICAgbmFtZTogY2FyZE1vZGFsQ2FwdGlvbklucHV0LnZhbHVlLFxyXG4gICAgbGluazogY2FyZE1vZGFsSW1hZ2VMaW5rSW5wdXQudmFsdWUsXHJcbiAgfTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGlucHV0VmFsdWVzKTtcclxuXHJcbiAgYXBpXHJcbiAgICAuYWRkTmV3Q2FyZChpbnB1dFZhbHVlcylcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNhcmRTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgICAgZGF0YS5uYW1lID0gY2FyZE1vZGFsQ2FwdGlvbklucHV0LnZhbHVlO1xyXG4gICAgICBkYXRhLmxpbmsgPSBjYXJkTW9kYWxJbWFnZUxpbmtJbnB1dC52YWx1ZTtcclxuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xyXG4gICAgICBldnQudGFyZ2V0LnJlc2V0KCk7XHJcbiAgICAgIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKCkgPT4ge1xyXG4gICAgICBjYXJkU3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlIGZhaWxlZC4gVHJ5IGFnYWluLlwiO1xyXG4gICAgICBjb25zb2xlLmVycm9yKCk7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIGNhcmRTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgICAgfSwgMjAwMCk7XHJcbiAgICB9KTtcclxuXHJcbiAgLy9cclxuXHJcbiAgLy9cclxuICAvLyAvLyBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdXR0b24sIHNldHRpbmdzKTtcclxuICAvL1xyXG59XHJcbi8vVXBkYXRlIFByb2ZpbGUgUGhvdG9cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGF2YXRhck1vZGFsU3VibWl0LnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuXHJcbiAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7XHJcbiAgICBhdmF0YXI6IGF2YXRhclBpY0xpbmsudmFsdWUsXHJcbiAgfTtcclxuICAvLyBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGlucHV0VmFsdWVzKTtcclxuXHJcbiAgYXBpXHJcbiAgICAuY2hhbmdlUHJvZmlsZVBpY3R1cmUoaW5wdXRWYWx1ZXMpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBhdmF0YXJNb2RhbFN1Ym1pdC50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgICBkYXRhLmF2YXRhciA9IGF2YXRhclBpY0xpbmsudmFsdWU7XHJcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xyXG4gICAgICBhdmF0YXJGb3JtLnJlc2V0KCk7XHJcbiAgICAgIHByb2ZpbGVJbWFnZS5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKCkgPT4ge1xyXG4gICAgICBhdmF0YXJNb2RhbFN1Ym1pdC50ZXh0Q29udGVudCA9IFwiU2F2ZSBmYWlsZWQuIFRyeSBhZ2Fpbi5cIjtcclxuICAgICAgY29uc29sZS5lcnJvcigpO1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICBhdmF0YXJNb2RhbFN1Ym1pdC50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgICB9LCAyMDAwKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vL0VkaXQgUHJvZmlsZSBJbmZvcm1hdGlvblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdCgpIHtcclxuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcclxuICBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50O1xyXG4gIHJlc2V0VmFsaWRhdGlvbihcclxuICAgIGVkaXRGb3JtRWxlbWVudCxcclxuICAgIFtlZGl0TW9kYWxOYW1lSW5wdXQsIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXRdLFxyXG4gICAgc2V0dGluZ3NcclxuICApO1xyXG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xyXG59XHJcblxyXG4vL1VwZGF0ZSBQcm9maWxlIE5hbWUgYW5kIERlc2NyaXB0aW9uXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHByb2ZpbGVFZGl0U3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICBhcGlcclxuICAgIC5lZGl0VXNlckluZm8oe1xyXG4gICAgICBuYW1lOiBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUsXHJcbiAgICAgIGFib3V0OiBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlLFxyXG4gICAgfSlcclxuICAgIC50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVFZGl0U3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLmFib3V0O1xyXG4gICAgICBjbG9zZU1vZGFsKGVkaXRNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKCgpID0+IHtcclxuICAgICAgcHJvZmlsZUVkaXRTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmUgZmFpbGVkLiBUcnkgYWdhaW4uXCI7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoKTtcclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlQnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICAgIH0sIDIwMDApO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycywgY2FyZElEIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICAvLyB0aGlzLmFib3V0ID0gYWJvdXQ7XHJcbiAgICAvLyB0aGlzLmF2YXRhciA9IGF2YXRhcjtcclxuICAgIC8vIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAvLyB0aGlzLl9pZCA9IF9pZDtcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gaWYgdGhlIHNlcnZlciByZXR1cm5zIGFuIGVycm9yLCByZWplY3QgdGhlIHByb21pc2VcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gaWYgdGhlIHNlcnZlciByZXR1cm5zIGFuIGVycm9yLCByZWplY3QgdGhlIHByb21pc2VcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHsgLi4udGhpcy5faGVhZGVycywgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHsgLi4udGhpcy5faGVhZGVycywgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gaWYgdGhlIHNlcnZlciByZXR1cm5zIGFuIGVycm9yLCByZWplY3QgdGhlIHByb21pc2VcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjaGFuZ2VMaWtlKGlkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7IC4uLnRoaXMuX2hlYWRlcnMsIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogeyAuLi50aGlzLl9oZWFkZXJzLCBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY2hhbmdlUHJvZmlsZVBpY3R1cmUoeyBhdmF0YXIgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHsgLi4udGhpcy5faGVhZGVycywgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIGlmIHRoZSBzZXJ2ZXIgcmV0dXJucyBhbiBlcnJvciwgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsic2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsImhpZGVJbnB1dEVycm9yIiwiZm9ybUVsIiwiaW5wdXRFbCIsImNvbmZpZyIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50IiwiaGFzSW52YWxpZElucHV0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJhZGQiLCJlbmFibGVWYWxpZGF0aW9uIiwiQXJyYXkiLCJmcm9tIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInNldEV2ZW50TGlzdGVuZXJzIiwiY29uc29sZSIsImxvZyIsImFkZEV2ZW50TGlzdGVuZXIiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNc2ciLCJhcGkiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJoZWFkZXJzIiwiY2FyZElEIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJJbmZvIiwiZmV0Y2giLCJtZXRob2QiLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiYWRkTmV3Q2FyZCIsIm5hbWUiLCJsaW5rIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJkZWxldGVDYXJkIiwiY2hhbmdlTGlrZSIsImlzTGlrZWQiLCJlZGl0VXNlckluZm8iLCJhYm91dCIsImNoYW5nZVByb2ZpbGVQaWN0dXJlIiwiYXZhdGFyIiwiYXV0aG9yaXphdGlvbiIsInByb2ZpbGVJbWFnZSIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwiZWRpdEZvcm1FbGVtZW50IiwiZm9ybXMiLCJwcm9maWxlRWRpdEJ1dHRvbiIsImNoYW5nZVByb2ZQaWMiLCJhdmF0YXJNb2RhbCIsImF2YXRhckZvcm0iLCJhdmF0YXJNb2RhbFN1Ym1pdCIsImF2YXRhclBpY0xpbmsiLCJlZGl0TW9kYWwiLCJlZGl0TW9kYWxOYW1lSW5wdXQiLCJlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUVkaXRTdWJtaXRCdXR0b24iLCJjYXJkTW9kYWxCdXR0b24iLCJjYXJkTW9kYWwiLCJjYXJkTW9kYWxJbWFnZUxpbmtJbnB1dCIsImNhcmRNb2RhbENhcHRpb25JbnB1dCIsImNhcmRNb2RhbEZvcm1FbGVtZW50IiwiY2FyZFN1Ym1pdEJ1dHRvbiIsImNhcmRzTGlzdCIsImNhcmRUZW1wbGF0ZSIsInByZXZpZXdNb2RhbCIsInByZXZpZXdNb2RhbEltYWdlIiwicHJldmlld01vZGFsQ2FwdGlvbiIsImRlbGV0ZU1vZGFsIiwiZGVsZXRlQnV0dG9uIiwiY2FuY2VsQnV0dG9uIiwic2VsZWN0ZWRDYXJkIiwic2VsZWN0ZWRDYXJkSWQiLCJjbG9zZUJ1dHRvbnMiLCJtb2RhbHMiLCJjYXJkcyIsInVzZXIiLCJpdGVtIiwiY2FyZEVsZW1lbnQiLCJnZXRDYXJkRWxlbWVudCIsImFwcGVuZCIsInNyYyIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwiZGF0YSIsImNsb3NlTW9kYWwiLCJzZXRUaW1lb3V0IiwiaW5wdXRWYWx1ZXMiLCJ0YXJnZXQiLCJyZXNldCIsInByZXBlbmQiLCJvcGVuTW9kYWwiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dCIsImhhbmRsZUNsaWNrT3V0c2lkZSIsIm1vZGFsIiwiY29udGFpbnMiLCJoYW5kbGVFc2NhcGVNb2RhbCIsImtleSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZEltYWdlIiwiYWx0IiwiY2FyZExpa2UiLCJfaWQiLCJoYW5kbGVMaWtlQ2FyZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJidXR0b24iLCJwb3B1cCIsImNsb3Nlc3QiXSwic291cmNlUm9vdCI6IiJ9